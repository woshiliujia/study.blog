---
title: ES6-8-迭代器与生成器
date: 2019-10-16 16:02:23
tags: ES6
categories: ES6
---


## 迭代器的高级功能

### 传递参数给迭代器
```
function *createIterator(){
    let first = yield 1;
    let second = yield first + 3;
}

let iterator = createIterator();

iterator.next();//1
iterator.next(4);//输出7  此处给next()传递了一个参数 该参数会成为生成器内部yield语句的值，即yield first值为4

//在迭代器中抛出错误
iterator.throw(new Error('bottom'));

```
迭代器中捕获错误
```
function *createIterator(){
    let first = yield 1;
    let second;
    try {
        second = yield first + 3;
    }catch{
        second = 6;
    }
    yield second + 3;
}

let iterator = createIterator();
console.log(iterator.next()) //输出 1
console.log(iterator.next(4)) //输出 7

//为什么会到执行到second = yield first + 3; 因为next()只会先执行 yield first + 3; 下次继续执行的时候 先给 second 赋值 导致出错，从而走 catch
console.log(iterator.throw(new Error("Boom")));//输出9 因为生成器内部捕获了错误，将second赋值为6然后继续执行到下一个yield
```
PS:next() 和 throw() 一样都是按序执行

### 生成器的 Return 语句
生成器函数如果不指定return 那么生成器函数一直会执行到最后一次返回，并且返回值也是最后一次执行的value

如果设置了return 可以提早结束执行，并且也可以将最后一次的值进行修改 
```
function *createIterator(){
    yield 1;
    return;//执行到此处后面就不再执行
    yield 2;
}
```

### 异步任务执行

```
//任何一个打算让任务运行器调用的函数，都应该返回一个执行回调函数的函数
function fetchData(){
    return function(callback){
        callback(null,'hi');
    }
}
```

